<!DOCTYPE html>
<html>
<head>
  <title>Matekarte</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
  <link rel="stylesheet" href="css/leaflet/MarkerCluster.css" />
  <link rel="stylesheet" href="css/leaflet/MarkerCluster.ClubMate.css" />
  <link rel="stylesheet" href="css/leaflet/Control.OSMGeocoder.css" />
  <link rel="stylesheet" href="css/leaflet/L.Control.Locate.min.css" />
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
  <script src="js/leaflet/leaflet.markercluster.js"></script>
  <script src="js/leaflet/leaflet-hash.js"></script>
  <script src="js/leaflet/Control.OSMGeocoder.js"></script>
  <script src="js/leaflet/L.Control.Locate.min.js"></script>
  <style type="text/css">
    #map {
      position: absolute;
      height: 100%;
      width: 100%;
    }
    body {
      margin: 0;
    }
  </style>
  <script src="js/icons.js"></script>
  <script src="js/club-mate-data.js"></script>
  <script type="text/javascript">
  function clubmatemap() {
    var icon_folder = 'icons';
    var icon_normal = L.icon({iconUrl: icon_folder + '/club-mate_24x24_-12x-12.png', iconSize: [24, 24] });
    var icon_retail = L.icon({iconUrl: icon_folder + '/club-mate-retail_30x40_-12x-28.png', iconSize: [30, 40] });
    var icon_served = L.icon({iconUrl: icon_folder + '/club-mate-served_32x40_-12x-28.png', iconSize: [32, 40] });
    // create a map in the "map" div, set the view to a given place and zoom
    var map = L.map('map').setView([50.813, 10.437], 7);
  
    // add an OpenStreetMap tile layer
    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);
  
    var markers = new L.MarkerClusterGroup({showCoverageOnHover: false, maxClusterRadius: 40});
    mate_locations_populate(markers);
    map.addLayer(markers);

    var options = {
      collapsed: true, /* Whether its collapsed or not */
      position: 'bottomleft', /* The position of the control */
      text: 'Locate', /* The text of the submit button */
      bounds: null, /* a L.LatLngBounds object to limit the results to */
      email: null, /* an email string with a contact to provide to Nominatim. Useful if you are doing lots of queries */
      callback: function (results) {
        var bbox = results[0].boundingbox,
            first = new L.LatLng(bbox[0], bbox[2]),
            second = new L.LatLng(bbox[1], bbox[3]),
            bounds = new L.LatLngBounds([first, second]);
        this._map.fitBounds(bounds);
      }
    };
    var osmGeocoder = new L.Control.OSMGeocoder(options);
    map.addControl(osmGeocoder);

    L.control.locate().addTo(map);

    scale = L.control.scale();
    scale.setPosition('bottomright');
    scale.addTo(map);

    var hash = new L.Hash(map);
  }
  </script>
</head>
<body onload="clubmatemap()">
  <div id="map"></div>
</body>
</html>
